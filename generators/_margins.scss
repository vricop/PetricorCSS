// Get options from margins module
$margins-module: map-get($modules, 'margins');
// Get options from negative-margins module
$negative-margins-module: map-get($modules, 'negative-margins');

// Builds rules for margin classes. It takes three arguments suffix, value
// and prefix (optional). It's used by margins() mixin.
@mixin margins-class-rules($suffix, $value, $prefix:null) {
  .#{$prefix}m-#{$suffix} { margin: $value; };
  .#{$prefix}mx-#{$suffix} { margin: { left: $value; right: $value; } };
  .#{$prefix}my-#{$suffix} { margin: { top: $value; bottom: $value; } };
  .#{$prefix}mt-#{$suffix} { margin-top: $value };
  .#{$prefix}mr-#{$suffix} { margin-right: $value };
  .#{$prefix}mb-#{$suffix} { margin-bottom: $value };
  .#{$prefix}ml-#{$suffix} { margin-left: $value };
}

// Generates different margin class variants based on config file values. It uses
// 'margins-class-rules' mixin to build variants based on arguments passed.
// '$breakpoints' parameter is only used wen called from '_responsive.scss' file,
// reponsible for building responsive variants.
@mixin margins($breakpoint: null) {
  // Execute only if module is set to true, is a string or contains a list
  @if ($margins-module == true) or (type-of($margins-module) == list) or (type-of($margins-module) == string) {
    @each $suffix, $value in $margins {
      // # DEFAULT CLASSES
      // If '$breakpoint' is null, generate default classes
      @if $breakpoint == null {
        @include margins-class-rules($suffix, $value);
      }

      // # RESPONSIVE CLASSES
      // 1. Execute if reponsive module is enabled and '$breakpoint' isn't null
      // 2. Add '$breakpoint\:' prefix for responsive variants
      @if index($margins-module, 'responsive') and $breakpoint != null {
        @include margins-class-rules($suffix, $value, '#{$breakpoint}\\:');
      }
      
      // # HOVER CLASSES
      // 1. Execute if 'hover' module is enabled and if '$breakpoint' is null
      // 2. Add ':hover' pseudo-selector and 'hover\:' prefix for hover variants
      @if index($margins-module, 'hover') and $breakpoint == null {
        @include margins-class-rules('#{$suffix}:hover', $value, 'hover\\:');
      }
    }

    // # NEGATIVE MARGIN CLASSES
    // Execute only if module is set to true, a list or a string
    @if ($negative-margins-module == true) or (type-of($negative-margins-module) == list) or (type-of($negative-margins-module) == string) {
      @each $suffix, $value in $negative-margins {
        // # DEFAULT CLASSES
        // 1. Execute only if  '$breakpoint' is null
        // 2. Generate classes with '-' as prefix
        @if $breakpoint == null {
          @include margins-class-rules($suffix, $value, '-');
        }

        // # RESPONSIVE NEGATIVE CLASSES
        // 1. Execute if reponsive module is enabled and '$breakpoint' isn't null
        // 2. Add '-' prefix variant for responsive negative margins
        @if index($negative-margins-module, 'responsive') and ($breakpoint != null) {
          @include margins-class-rules($suffix, $value, '#{$breakpoint}\\:-');
        }

        // # HOVER NEGATIVE CLASSES
        // 1. Execute if 'hover' module is enabled and if '$breakpoint' is null
        // 2. Add ':hover' pseudo-class, 'hover\:' prefix and 'hover\:-' suffix
        //    for hover variants
        @if index($negative-margins-module, 'hover') and ($breakpoint == null) {
          @include margins-class-rules('#{$suffix}:hover', $value, 'hover\\:-');
        }
      }
    }
  }
}